# Implementation Plan: News Feed & Automation System

Этот план описывает этапы разработки системы агрегации новостей, включая бэкенд-сервисы, интеграцию с ИИ, панель управления и мобильный интерфейс.

## Phase 1: База данных и Базовая структура API (Backend)
- [x] **Task 1: Проектирование и миграция БД** ✅
    - Создать модели `NewsSource` (источники) и `NewsItem` (новости).
    - Предусмотреть поля для мультиязычности (RU/EN), статусов модерации, тегов и метаданных источника.
    - Выполнить миграцию GORM.
- [x] **Task 2: Базовый API CRUD для новостей и источников** ✅
    - Реализовать эндпоинты для управления источниками (только для админа).
    - Реализовать эндпоинты для получения списка новостей с пагинацией и фильтрами.
- [x]**Task: Conductor - User Manual Verification 'Phase 1: База данных и Базовая структура API' (Protocol in workflow.md)**

## Phase 2: Система парсинга (Backend - Go/Python)
- [x] **Task 1: Реализация универсального интерфейса парсера** ✅
    - Создать структуру для расширяемых парсеров.
- [x] **Task 2: Парсеры для RSS и прямых ссылок** ✅
    - Реализовать извлечение контента из RSS-лент и HTML-страниц (мета-теги, OpenGraph).
- [x] **Task 3: Интеграция с ВК и Telegram** ✅
    - Реализовать получение постов из публичных групп ВК и ТГ-каналов.
- [x] **Task 4: Фоновый планировщик задач** ✅
    - Настроить периодический запуск парсеров (например, через cron или внутренний воркер).
- [x] **Task: Conductor - User Manual Verification 'Phase 2: Система парсинга' (Protocol in workflow.md)**

## Phase 3: AI Pipeline - Обработка контента (Python/Go)
- [x] **Task 1: Интеграция с LLM (Summarization & Style Transfer)** ✅
    - Настроить промпты для переписывания текста в "Sattva" стиле и генерации кратких выжимок.
- [x] **Task 2: Авто-тегирование и перевод** ✅
    - Реализовать классификатор тем и автоматический перевод контента (RU <-> EN).
- [x] **Task 3: Оркестрация пайплайна** ✅
    - Связать парсер с AI-сервисом: сохранение "сырого" контента -> обработка ИИ -> сохранение результата/черновика.
- [x] **Task: Conductor - User Manual Verification 'Phase 3: AI Pipeline - Обработка контента' (Protocol in workflow.md)**

## Phase 4: Панель администратора (Next.js)
- [x] **Task 1: Интерфейс управления источниками** ✅
    - Создать формы для добавления/редактирования ВК, ТГ, RSS ссылок и настроек автоматизации.
- [x] **Task 2: Модерация новостей** ✅
    - Реализовать список черновиков с возможностью предпросмотра, редактирования и публикации.
    - Реализовать редактор новостей (Markdown/Rich Text).
- [x] **Task: Conductor - User Manual Verification 'Phase 4: Панель администратора' (Protocol in workflow.md)**

## Phase 5: Мобильное приложение (React Native)
- [x] **Task 1: Реальная лента новостей** ✅
    - Заменить заглушки в разделе "Новости" на реальные данные из API.
    - Добавить поддержку двух языков и фильтрацию по категориям.
    - **Реализовать экран детального просмотра новости с очисткой текста от артефактов.**
- [x] **Task 2: Виджет на Главном экране** ✅
    - Создать компонент виджета для Dashboard.
    - Реализовать логику "последних новостей" и переход к полноэкранному просмотру.
- [x] **Task 3: Интеграция с AI Assistant** ✅
    - Добавить функционал в чат, позволяющий боту искать и суммировать последние новости из БД.
- [x] **Task 4: Переход к оригинальному источнику (Видео/Аудио)** ✅
    - Реализовать функционал открытия оригинальных постов для просмотра медиа-контента.
- [x] **Task: Conductor - User Manual Verification 'Phase 5: Мобильное приложение' (Protocol in workflow.md)** ✅

## Phase 6: Финализация и Push-уведомления
- [x] **Task 1: Интеграция Push-уведомлений** ✅
    - Реализовать отправку уведомлений при публикации новости с флагом "Важное".
- [x] **Task 2: Нагрузочное тестирование и оптимизация** (❗ Опционально)
    - Проверить работу парсеров под нагрузкой и кэширование запросов новостей.
- [x] **Task: Conductor - User Manual Verification 'Phase 6: Финализация и Push-уведомления' (Protocol in workflow.md)**

## Phase 7: Персонализация (Подписки и Избранное)
- [x] **Task 1: Бэкенд - Модели и API** ✅
    - Создать модель `UserNewsSubscription` (связь Many-to-Many между `User` и `NewsSource`).
    - Реализовать API для подписки/отписки на источник (`POST /subscribe`, `DELETE /subscribe`).
    - Реализовать API для добавления источника в избранное (`POST /favorite`, `DELETE /favorite`).
- [x] **Task 2: Бэкенд - Таргетированная рассылка уведомлений** ✅
    - Обновить логику `PublishNews` для отправки пушей только подписанным пользователям.
    - Оптимизировать выборку токенов (Multicast).
- [x] **Task 3: Мобильное приложение - UI Подписок** ✅
    - Добавить кнопку "Колокольчик" (Push) и "Звездочку" (Избранное) в карточку новости или источника.
    - Создать экран управления подписками (список всех источников с переключателями).
- [x] **Task: Conductor - User Manual Verification 'Phase 7: Персонализация'**