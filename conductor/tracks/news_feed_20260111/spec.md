# Specification: News Feed & Automation System

## 1. Overview
Разработка комплексной системы агрегации, обработки и публикации новостей для платформы. Система должна автоматически собирать контент из различных источников (ВК, Telegram, RSS, сайты), обрабатывать его с помощью ИИ (стилизация, перевод, тегирование) и предоставлять администратору гибкие инструменты для управления публикациями. В мобильном приложении новости должны отображаться в специальном разделе и на главном экране.

## 2. Functional Requirements

### 2.1. Backend (Data Collection & Parsing)
*   **Universal Parser Service:** Сервис для сбора контента по расписанию.
*   **Supported Sources:**
    *   **VKontakte:** Интеграция с API (или скрапинг) для получения постов из групп.
    *   **Telegram:** Получение постов из публичных каналов (через MTProto или Bot API).
    *   **RSS Feeds:** Стандартный парсинг XML лент.
    *   **Direct URLs:** Парсинг контента конкретной статьи по ссылке.
*   **Content Extraction:** Извлечение заголовка, основного текста, изображений и ссылок на оригинал.

### 2.2. AI Processing Engine
*   **Pipeline:** Каждый полученный материал проходит через цепочку обработки:
    1.  **Summarization:** Генерация краткого описания (lead) для ленты.
    2.  **Style Transfer:** Рерайтинг текста в "благостном" (Sattva) стиле, удаление агрессии, приведение к tone-of-voice платформы.
    3.  **Auto-tagging:** Определение категории и генерация тегов.
    4.  **Translation:** Автоматический перевод (RU <-> EN) для поддержки обоих языков приложения.
    5.  **Media Handling:** Выбор основного изображения или генерация промпта для его создания (если изображения нет).

### 2.3. Admin Panel & Management
*   **Source Management:** CRUD (Create, Read, Update, Delete) интерфейс для источников данных. Настройка типа источника, URL и частоты опроса.
*   **Moderation Workflow (Configurable per source):**
    *   *Auto-publish:* Публикация сразу после обработки.
    *   *Draft/Review:* Сохранение как черновик для ручной проверки.
*   **News Editor:**
    *   Просмотр списка новостей (Опубликовано, Черновики, Удалено).
    *   Редактирование сгенерированного ИИ контента перед публикацией.
    *   Ручное создание новостей с нуля.
    *   Планировщик публикаций (Scheduled Publishing).
*   **Statistics:** Базовая аналитика просмотров (если применимо на данном этапе).

### 2.4. Mobile App (Frontend)
*   **News Screen:** Замена текущих заглушек на реальную ленту новостей с бесконечным скроллом и фильтрацией по тегам.
*   **Dashboard Widget:** Виджет "Последние новости" на главном экране (архитектурно предусмотреть добавление других виджетов рядом, например, "Сообщения").
*   **AI Assistant Integration:** Возможность запросить "Сводку новостей" в чате с ассистентом.
*   **Push Notifications:** Отправка уведомлений при публикации важных новостей (флаг "Важное" в админке).

## 3. Non-Functional Requirements
*   **Extensibility:** Архитектура парсера должна позволять легко добавлять новые типы источников.
*   **Reliability:** Обработка ошибок парсинга (битые ссылки, недоступность источника) без падения сервиса.
*   **Performance:** Асинхронная обработка новостей в фоновом режиме (Task Queue), чтобы не блокировать основной API.

## 4. Acceptance Criteria
*   [ ] Парсер успешно собирает новости из тестовой группы ВК, ТГ-канала и RSS-ленты.
*   [ ] ИИ корректно переписывает текст и генерирует переводы; результат сохраняется в БД.
*   [ ] Админ может добавить новый источник и настроить режим премодерации.
*   [ ] В админке можно отредактировать и опубликовать черновик новости.
*   [ ] В приложении на Главном экране отображаются 3 последние новости.
*   [ ] Раздел "Новости" в приложении отображает полный список с пагинацией.
*   [ ] AI-ассистент может ответить на вопрос "Что нового?".

## 5. Out of Scope (for this track)
*   Сложная система рекомендаций (персонализация ленты под каждого пользователя).
*   Комментарии и лайки к новостям (если не предусмотрено базовой архитектурой, лучше вынести в следующий этап).
