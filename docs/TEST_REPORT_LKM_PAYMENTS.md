# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞—Ç–µ–∂–µ–π LKM

**–î–∞—Ç–∞:** 2026-02-14  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ PASS (–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã)  
**–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤:** 78 (30 –±—ç–∫–µ–Ω–¥ + 48 —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)

---

## üõ†Ô∏è –ë—ç–∫–µ–Ω–¥ (Go)
**–§–∞–π–ª:** `server/internal/services/wallet_service_test.go`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 30 —Ç–µ—Å—Ç–æ–≤ (0 –ø—Ä–æ–≤–∞–ª–µ–Ω–æ)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
1.  **calculateSpendAllocation (Core Logic):**
    *   –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –∏ –±–æ–Ω—É—Å–Ω—ã–π –±–∞–ª–∞–Ω—Å—ã.
    *   –£—á–µ—Ç –ª–∏–º–∏—Ç–æ–≤ `%` –∏ –∞–±—Å–æ–ª—é—Ç–Ω–æ–π —Å—É–º–º—ã (`MaxBonusAmount`).
    *   "–°–¥–≤–∏–≥" –±–æ–Ω—É—Å–æ–≤ (bonus shift), –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç (–ø—Ä–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–º 100% –±–æ–Ω—É—Å–µ).
    *   –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π (–Ω—É–ª–µ–≤–æ–π –±–∞–ª–∞–Ω—Å, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã).
2.  **normalizeSpendOptions:**
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø—Ä–æ—Ü–µ–Ω—Ç—ã > 100 –∏–ª–∏ < 0).
    *   –°–±—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±–æ–Ω—É—Å–æ–≤.
3.  **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:**
    *   `regular + bonus == total` (–≤—Å–µ–≥–¥–∞).
    *   –°–ø–∏—Å–∞–Ω–∏—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏.

---

## üì± –§—Ä–æ–Ω—Ç–µ–Ω–¥ (React Native)
**–§–∞–π–ª:** `frontend/__tests__/services/walletService.test.ts`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 48 —Ç–µ—Å—Ç–æ–≤ (0 –ø—Ä–æ–≤–∞–ª–µ–Ω–æ)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
1.  **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ i18n:**
    *   –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–æ–≤ –≤–∞–ª—é—Ç (LKM) –∏ —Å–∏–º–≤–æ–ª–æ–≤.
    *   –ü–µ—Ä–µ–≤–æ–¥ —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –°–ø–∏—Å–∞–Ω–∏–µ, –ë–æ–Ω—É—Å –∏ —Ç.–¥.).
    *   –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –≤–∞–ª—é—Ç—ã (`ru` -> –õ–∞–∫—à–º–∞–Ω–∏, `en` -> LakshMoney).
2.  **–•–µ–ª–ø–µ—Ä—ã (Wallet Helpers):**
    *   `getTransactionAmountParts`: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å—É–º–º—ã –∏–∑ API (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ regular/bonus).
    *   `getTransactionSign`: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞–∫–∏ (+ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π, - –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏–π, ‚éî –¥–ª—è —Ö–æ–ª–¥–∞).
    *   `formatTransactionAmount`: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `-10 LKM`).
    *   `isBonusTransaction`: –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±–æ–Ω—É—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
3.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (UI Logic):**
    *   –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: Hold (–ó–∞–º–æ—Ä–æ–∑–∫–∞) -> Release (–°–ø–∏—Å–∞–Ω–∏–µ) -> Credit (–ó–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É).
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ (Refund) —Å –±–æ–Ω—É—Å–Ω–æ–π —á–∞—Å—Ç—å—é.

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –û–±–ª–∞—Å—Ç—å | –¢–µ—Å—Ç—ã | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| –õ–æ–≥–∏–∫–∞ –±–æ–Ω—É—Å–æ–≤ (Backend) | 21 | ‚úÖ |
| –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤ (Backend) | 7 | ‚úÖ |
| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Frontend) | 15 | ‚úÖ |
| –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (Frontend) | 4 | ‚úÖ |
| –õ–æ–≥–∏–∫–∞ –±–æ–Ω—É—Å–æ–≤ (Frontend) | 13 | ‚úÖ |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã | 4 | ‚úÖ |
| **–ò–¢–û–ì–û** | **78** | **PASS** |

---
**–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫:** Antigravity (Assistant)
