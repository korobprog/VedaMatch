# Процесс регистрации и заполнения анкеты в VedaMatch

В этом документе описаны этапы регистрации пользователей, включая технические и функциональные аспекты заполнения профиля.

---

## 1. Входной этап (Pre-registration)

### Preview-экран
При первом запуске приложения неавторизованного пользователя встречает **PreviewScreen**. 
- Проигрывается видео-ролик (`prevy.mp4`), создающий атмосферу проекта.
- После окончания видео или по нажатию на экран открывается основной поток авторизации.

### Реферальная система (Invite Code)
Приложение поддерживает виральные механики приглашений.
- Пользователь может ввести **Invite Code** на этапе регистрации.
- Код связывает нового пользователя с пригласителем в базе данных.
- При успешной регистрации через инвайт-код могут начисляться бонусы во внутренней валюте **LKM**.

---

## 2. Основная регистрация (Phase 1: Initial)

Регистрация проходит через экран `RegistrationScreen.tsx` в два этапа.

### Шаг 1: Создание учетной записи
Пользователь заполняет базовые данные для аутентификации:
- **Email**: Основной идентификатор.
- **Password**: Пароль с обязательным подтверждением (`Confirm Password`).
- **Invite Code**: Опциональное поле для ввода кода друга.
- **Технические данные**: Приложение автоматически получает `Unique Device ID` для привязки аккаунта к устройству.

**Результат этапа:**
1. На бэкенде создается запись в таблице `users`.
2. Генерируется уникальный инвайт-код для самого нового пользователя.
3. Каждому новому пользователю автоматически создается **кошелек** (Wallet).
4. Пользователь получает JWT-токен и авторизуется в системе.

---

## 3. Заполнение анкеты (Phase 2: Profile Update)

Второй этап регистрации посвящен детальному заполнению профиля («анкеты»).

### Основные блоки данных:
1.  **Медиа**: Загрузка аватара (через `AvatarUploader`).
2.  **Личные данные**:
    *   **Karmic Name**: Гражданское имя.
    *   **Spiritual Name**: Духовное имя (если есть).
    *   **Gender**: Пол.
    *   **DOB (Date of Birth)**: Дата рождения (используется календарь).
3.  **Локация**:
    *   Выбор страны и города из списков.
    *   **Автоопределение**: Кнопка «Detect Location» для автоматического поиска координат и заполнения адреса.
    *   Данные координат (Lat/Long) сохраняются для корректного отображения на карте.
4.  **Духовные параметры**:
    *   **Madh (Tradition)**: Выбор духовной традиции (сампрадаи).
    *   **Mentor**: Имя наставника/гуру.
    *   **Identity**: Самоидентификация (брахман, кшатрий и т.д.).
    *   **Yoga Style**: Предпочтения в практике йоги.
    *   **Guna**: Преобладающая гуна материальной природы.
    *   **Diet**: Тип питания (Веган, Вегетарианец, Прасад).

---

## 4. Особенности процесса

### Пропуск заполнения (Skip)
Пользователь может нажать кнопку **Skip** на этапе заполнения анкеты.
- **Последствия**: Приложение выдаст предупреждение, что профиль не заполнен.
- **Ограничения**: До завершения профиля (`IsProfileComplete: true`) некоторые сервисы «Портала» (например, Знакомства или определенные фильтры) могут быть недоступны.

### Валидация
Бэкенд сохраняет данные и меняет флаг `IsProfileComplete` на `true` только после успешного выполнения запроса `update-profile`. Это является сигналом для приложения, что пользователь прошел полный путь онбординга.

### Мультиязычность
Все поля анкеты, подсказки и ошибки поддерживают локализацию (RU/EN) через систему `i18next`.
